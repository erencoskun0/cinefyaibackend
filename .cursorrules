# CinefyAI Sinema Rezervasyon Sistemi - Cursor Rules

Bu proje, kullanÄ±cÄ±larÄ±n sinema salonlarÄ±nÄ±, seanslarÄ± gÃ¶rÃ¼ntÃ¼leyip bilet alabildiÄŸi modern bir sinema rezervasyon sistemidir.

## ğŸ“‹ Proje Ã–zeti
- **Teknoloji Stack**: ASP.NET Core 9.0, Entity Framework Core, SQL Server, ASP.NET Identity
- **Mimari**: Clean Architecture, Domain-Driven Design prensipleri
- **VeritabanÄ±**: MSSQL Server, Code-First yaklaÅŸÄ±mÄ±
- **Auth**: ASP.NET Identity ile kullanÄ±cÄ± yÃ¶netimi

## ğŸ—ï¸ Temel Entity YapÄ±sÄ±
- **User**: ASP.NET Identity tabanlÄ± kullanÄ±cÄ± sistemi
- **Cinema**: Sinema salonlarÄ± ve sahipleri
- **Hall**: Sinema salonlarÄ±na ait mÃ¼zik/film salonlarÄ±
- **Seat**: Salonlardaki koltuk bilgileri
- **Movie**: Film bilgileri (AI etiketleme destekli)
- **Show**: Seanslar (film + salon + tarih/saat)
- **Ticket**: Bilet rezervasyonlarÄ±
- **Review**: Film deÄŸerlendirmeleri
- **AILog**: AI Ã¶neri loglarÄ±

## ğŸ¯ Kodlama StandartlarÄ±

### C# ve .NET KurallarÄ±
- **Naming**: PascalCase (sÄ±nÄ±flar, metodlar), camelCase (local deÄŸiÅŸkenler)
- **Async/Await**: TÃ¼m veritabanÄ± iÅŸlemleri async olmalÄ±
- **Nullable**: Nullable reference types kullan (`<Nullable>enable</Nullable>`)
- **Using Statements**: File-scoped using statements tercih et
- **Primary Constructors**: .NET 9.0 Ã¶zelliklerini kullan

### Entity Framework KurallarÄ±
- **DbContext**: `ApplicationDbContext` sÄ±nÄ±fÄ±nÄ± kullan
- **Migrations**: Code-First yaklaÅŸÄ±mÄ±, migration'larÄ± dÃ¼zenli gÃ¼ncelle
- **Relationships**: Fluent API ile iliÅŸkileri `OnModelCreating` iÃ§inde tanÄ±mla
- **Lazy Loading**: Navigation property'ler iÃ§in include kullan
- **Concurrency**: Optimistic concurrency kontrolÃ¼ ekle

### API Design KurallarÄ±
- **RESTful**: REST prensiplerini takip et
- **Status Codes**: DoÄŸru HTTP status kodlarÄ± kullan
- **DTOs**: Entity'leri direkt dÃ¶nme, DTO kullan
- **Validation**: Model validation attribute'larÄ± kullan
- **Error Handling**: Global exception handling middleware ekle

## ğŸ“ Dosya ve KlasÃ¶r YapÄ±sÄ±

```
CinefyAiServer/
â”œâ”€â”€ Controllers/           # API Controller'lar
â”œâ”€â”€ Entities/             # Domain Entity'ler
â”‚   â”œâ”€â”€ DTOs/            # Data Transfer Objects
â”‚   â””â”€â”€ *.cs             # Entity sÄ±nÄ±flarÄ±
â”œâ”€â”€ Data/                # DbContext ve konfigÃ¼rasyonlar
â”œâ”€â”€ Services/            # Business logic servisler
â”œâ”€â”€ Repositories/        # Repository pattern
â”œâ”€â”€ Middlewares/         # Custom middleware'ler
â”œâ”€â”€ Extensions/          # Extension metodlar
â”œâ”€â”€ Configurations/      # Startup konfigÃ¼rasyonlarÄ±
â”œâ”€â”€ Migrations/          # EF Core migration'larÄ±
â””â”€â”€ Helpers/            # YardÄ±mcÄ± sÄ±nÄ±flar
```

## ğŸ” GÃ¼venlik KurallarÄ±
- **Authentication**: ASP.NET Identity kullan
- **Authorization**: Role-based yetkilendirme (User, Cinema Owner, Admin)
- **Password**: BCrypt.Net ile hash'leme
- **CORS**: Gerekli origin'lere izin ver
- **Input Validation**: TÃ¼m input'larÄ± validate et
- **SQL Injection**: EF Core parametrized queries kullan

## ğŸ¬ Ä°ÅŸ KurallarÄ±

### Rezervasyon Sistemi
- Bir kullanÄ±cÄ± aynÄ± seansa birden fazla bilet alabilir
- AynÄ± koltuk aynÄ± seans iÃ§in sadece bir kez satÄ±labilir
- GeÃ§miÅŸ tarihli seanslar iÃ§in bilet satÄ±lamaz
- QR kod her bilet iÃ§in unique olmalÄ±

### Sinema YÃ¶netimi
- Cinema Owner sadece kendi sinemalarÄ±nÄ± yÃ¶netebilir
- Admin tÃ¼m sinemalarÄ± yÃ¶netebilir
- Hall'lar silindiÄŸinde tÃ¼m seat'lar silinir (Cascade)
- Show silindiÄŸinde ticket'lar silinir (Cascade)

### Film ve Seans YÃ¶netimi
- Film'ler IsActive = false ile soft delete
- Show'lar gelecek tarih/saat iÃ§in oluÅŸturulabilir
- Movie'lere AI tag'larÄ± otomatik eklenebilir
- Review sadece geÃ§miÅŸ seanslarÄ± izlemiÅŸ kullanÄ±cÄ±lar yapabilir

## ğŸ“Š Performans KurallarÄ±
- **Indexing**: SÄ±k sorgulanan alanlara index ekle
- **Caching**: Memory cache veya Redis kullan
- **Pagination**: BÃ¼yÃ¼k veri setleri iÃ§in sayfalama
- **Lazy Loading**: Include ile explicit loading
- **Connection Pooling**: EF Core connection pooling aktif

## ğŸ§ª Test KurallarÄ±
- **Unit Tests**: xUnit framework kullan
- **Integration Tests**: TestServer ile API testleri
- **Repository Tests**: InMemory database ile test
- **Mock**: Moq framework ile dependency mocking
- **Coverage**: Minimum %80 kod kapsamÄ± hedefle

## ğŸ“ API Endpoint Ã–rnekleri

```csharp
// Show Controller Endpoints
GET    /api/shows                          # TÃ¼m seanslar
GET    /api/shows/date/{date}              # Tarihe gÃ¶re seanslar
GET    /api/shows/cinema/{cinemaId}        # Sinemaya gÃ¶re seanslar
POST   /api/shows                          # Yeni seans oluÅŸtur
PUT    /api/shows/{id}                     # Seans gÃ¼ncelle
DELETE /api/shows/{id}                     # Seans sil

// Ticket Controller Endpoints
GET    /api/tickets/user/{userId}          # KullanÄ±cÄ±nÄ±n biletleri
POST   /api/tickets                        # Bilet satÄ±n al
GET    /api/tickets/{id}/qr                # QR kod
DELETE /api/tickets/{id}                   # Bilet iptal
```

## ğŸ”„ Migration KurallarÄ±
- Migration adlarÄ± aÃ§Ä±klayÄ±cÄ± olsun: `Add_Show_Entity_And_Relations`
- Seed data iÃ§in separate migration'lar oluÅŸtur
- Production'da migration'larÄ± otomatik Ã§alÄ±ÅŸtÄ±r
- Rollback planÄ± her migration iÃ§in hazÄ±r olsun

## ğŸ“± Frontend Entegrasyonu (Gelecek)
- CORS policy'si frontend URL'leri iÃ§in hazÄ±r
- JWT token authentication desteÄŸi
- Real-time bildirimler iÃ§in SignalR hazÄ±rlÄ±ÄŸÄ±
- API versioning desteÄŸi

## ğŸ¨ Code Style
- EditorConfig dosyasÄ± kullan
- Code analysis rules aktif
- XML documentation comments ekle
- Kod formatÄ± iÃ§in otomatik formatter

Bu kurallar projenin tutarlÄ±lÄ±ÄŸÄ±nÄ±, performansÄ±nÄ± ve maintainability'sini saÄŸlamak iÃ§in tasarlanmÄ±ÅŸtÄ±r. 